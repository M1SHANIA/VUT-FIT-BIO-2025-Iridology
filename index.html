<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Iridology â€” Advanced Iris Analysis</title>
    <link rel="stylesheet" href="/src/style.css" />
    <!-- OpenCV.js from official docs (auto-updates). If you're offline, supply a local opencv.js build. -->
    <script
      async
      src="https://docs.opencv.org/4.x/opencv.js"
      onload="onOpenCvReady()"
    ></script>
    <script type="module" src="/src/main.js"></script>
  </head>
  <body>
    <!-- OpenCV Loading Overlay -->
    <div id="cvLoader" class="loader-overlay" style="display: flex">
      <div class="loader-container">
        <div class="spinner"></div>
        <p class="loader-text">Loading OpenCV...</p>
      </div>
    </div>

    <main class="main-content">
      <section class="analysis-section">
        <h2 class="section-title">Iris Analysis</h2>
        <div class="eyes-container">
          <div class="eye-card" id="leftCard">
            <div class="eye-header">
              <h3>ğŸ‘ï¸ Left Eye</h3>
              <span class="eye-label">Left</span>
            </div>
            <div class="controls">
              <input id="leftFile" type="file" accept="image/*" />
              <button id="leftCamBtn" class="btn btn-primary">ğŸ“· Camera</button>
              <button id="leftClearBtn" class="btn btn-secondary">
                ğŸ—‘ï¸ Clear
              </button>
            </div>
            <canvas
              id="leftCanvas"
              width="640"
              height="480"
              class="eye-canvas"
            ></canvas>
            <div id="leftMsg" class="message" aria-live="polite"></div>
            <div
              id="leftUnwrapContainer"
              class="unwrap-container"
              style="display: none"
            >
              <h4>ğŸ“Š Unwrapped Iris Map</h4>
              <canvas
                id="leftUnwrapCanvas"
                width="2000"
                height="2000"
                class="unwrap-canvas"
              ></canvas>
              <button
                id="leftViewFullBtn"
                class="btn btn-primary"
                style="margin-top: 1rem; width: 100%"
              >
                ğŸ‘ï¸ View Full Screen
              </button>
            </div>
          </div>

          <div class="eye-card" id="rightCard">
            <div class="eye-header">
              <h3>ğŸ‘ï¸ Right Eye</h3>
              <span class="eye-label">Right</span>
            </div>
            <div class="controls">
              <input id="rightFile" type="file" accept="image/*" />
              <button id="rightCamBtn" class="btn btn-primary">
                ğŸ“· Camera
              </button>
              <button id="rightClearBtn" class="btn btn-secondary">
                ğŸ—‘ï¸ Clear
              </button>
            </div>
            <canvas
              id="rightCanvas"
              width="640"
              height="480"
              class="eye-canvas"
            ></canvas>
            <div id="rightMsg" class="message" aria-live="polite"></div>
            <div
              id="rightUnwrapContainer"
              class="unwrap-container"
              style="display: none"
            >
              <h4>ğŸ“Š Unwrapped Iris Map</h4>
              <canvas
                id="rightUnwrapCanvas"
                width="2000"
                height="2000"
                class="unwrap-canvas"
              ></canvas>
              <button
                id="rightViewFullBtn"
                class="btn btn-primary"
                style="margin-top: 1rem; width: 100%"
              >
                ğŸ‘ï¸ View Full Screen
              </button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Result Modal -->
    <div id="resultModal" class="modal-fullscreen" style="display: none">
      <div class="modal-content-fullscreen">
        <div class="modal-header-fullscreen">
          <h2 id="modalTitle">Analysis Result</h2>

          <button id="closeModal" class="close-btn">&times;</button>
        </div>
        <div class="modal-body-fullscreen">
          <canvas
            id="resultCanvas"
            width="2000"
            height="2000"
            class="result-canvas-fullscreen"
          ></canvas>
        </div>
        <div class="modal-footer-fullscreen">
          <label class="toggle-label">
            <input type="checkbox" id="toggleMapVisibility" checked />
            <span>Show Map</span>
          </label>
          <button id="downloadBtn" class="btn btn-primary">â¬‡ï¸ Download</button>
          <button id="closeModalBtn" class="btn btn-secondary">Close</button>
        </div>
      </div>
    </div>
  </body>
</html>
